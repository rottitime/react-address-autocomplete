{"version":3,"file":"AddressAutocomplete.stories-15658595.js","sources":["../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/react/jsx-runtime.js","../../src/hooks/useDebounce.ts","../../src/hooks/useFetch.ts","../../src/components/Loader.tsx","../../src/components/AddressAutocomplete.tsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","import React from 'react'\n\nexport default function useDebounce(value: unknown, delay = 500) {\n  const [debouncedValue, setDebouncedValue] = React.useState(value)\n\n  React.useEffect(() => {\n    const handler: NodeJS.Timeout = setTimeout(() => {\n      setDebouncedValue(value)\n    }, delay)\n\n    // Cancel the timeout if value changes (also on delay change or unmount)\n    return () => {\n      clearTimeout(handler)\n    }\n  }, [value, delay])\n\n  return debouncedValue\n}\n","import { useState } from 'react'\nimport { CountryCodes, MapData } from '../types'\n\ntype ApiParams = {\n  q: string\n  format: 'xml' | 'json' | 'jsonv2' | 'geojson' | 'geocodejson'\n  addressdetails: string\n  limit: string\n  countrycodes?: string\n}\n\nexport type Props = {\n  countrycodes?: (keyof typeof CountryCodes)[]\n}\n\nconst apiUrl = 'https://nominatim.openstreetmap.org/search'\n// const apiUrl = 'https://127.0.0.1/search'\n\nconst useFetch = ({ countrycodes = [] }: Props) => {\n  const [status, setStatus] = useState<'idle' | 'fetching' | 'fetched'>('idle')\n  const [data, setData] = useState<MapData[]>([])\n\n  const clear = () => setData([])\n\n  const setAddress = async (address: string) => {\n    if (address.length > 2) {\n      const params: ApiParams = {\n        q: address,\n        format: 'json',\n        addressdetails: '1',\n        limit: '10',\n        countrycodes: countrycodes.join(',')\n      }\n\n      setStatus('fetching')\n      try {\n        const res = await fetch(`${apiUrl}?${new URLSearchParams(params).toString()}`)\n        const data = await res.json()\n        setData(data)\n        setStatus('fetched')\n      } catch (e) {\n        console.error(e)\n      }\n    } else {\n      setData([])\n      setStatus('fetched')\n    }\n  }\n\n  return { status, data, setAddress, clear } as const\n}\n\nexport default useFetch\n","import React, { SVGProps, Ref, forwardRef } from 'react'\n\nconst SvgComponent = (props: SVGProps<SVGSVGElement>, ref: Ref<SVGSVGElement>) => (\n  <svg\n    height=\"1em\"\n    viewBox=\"0 0 24 24\"\n    width=\"1em\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    data-name=\"Layer 1\"\n    ref={ref}\n    {...props}\n  >\n    <path d=\"M13 1v2a1 1 0 0 1-2 0V1a1 1 0 0 1 2 0zm-1 19a1 1 0 0 0-1 1v2a1 1 0 0 0 2 0v-2a1 1 0 0 0-1-1zm-8-8a1 1 0 0 0-1-1H1a1 1 0 0 0 0 2h2a1 1 0 0 0 1-1zm19-1h-2a1 1 0 0 0 0 2h2a1 1 0 0 0 0-2zm-4.982-9.382a1 1 0 0 0-1.367.364l-1 1.731a1 1 0 0 0 .365 1.366.987.987 0 0 0 .5.135 1 1 0 0 0 .866-.5l1-1.731a1 1 0 0 0-.364-1.365zM7.987 18.921a1 1 0 0 0-1.366.364l-1 1.731a1 1 0 0 0 .364 1.366.989.989 0 0 0 .5.135 1 1 0 0 0 .867-.5l1-1.731a1 1 0 0 0-.365-1.365zm-3.272-12.3-1.731-1a1 1 0 0 0-1 1.731l1.731 1a1 1 0 0 0 1-1.731zm17.3 10.03-1.731-1a1 1 0 0 0-1 1.731l1.731 1a.987.987 0 0 0 .5.135 1 1 0 0 0 .5-1.866zM7.349 1.982a1 1 0 0 0-1.731 1l1 1.731a1 1 0 0 0 .866.5.987.987 0 0 0 .5-.135 1 1 0 0 0 .365-1.366zm10.03 17.3a1 1 0 0 0-1.731 1l1 1.731a1 1 0 0 0 1.731-1zm2.408-10.8a1 1 0 0 0 .5-.134l1.731-1a1 1 0 0 0-1-1.731l-1.731 1a1 1 0 0 0 .5 1.865zM3.713 15.648l-1.731 1a1 1 0 0 0 .5 1.866.987.987 0 0 0 .5-.135l1.731-1a1 1 0 0 0-1-1.731z\" />\n  </svg>\n)\n\nconst ForwardRef = forwardRef(SvgComponent)\nexport default ForwardRef\n","import React, {\n  ChangeEvent,\n  InputHTMLAttributes,\n  useEffect,\n  useId,\n  useState\n} from 'react'\nimport useDebounce from '../hooks/useDebounce'\nimport useFetch, { Props as useFetchProps } from '../hooks/useFetch'\nimport { MapData } from '../types'\nimport './AddressAutocomplete.css'\nimport Loader from './Loader'\n\ntype Props = {\n  label?: string\n  disableStyles?: boolean\n  onSelected?: (data: MapData) => void\n  onChange?: (event: ChangeEvent<HTMLInputElement>) => void\n} & Pick<useFetchProps, 'countrycodes'> &\n  InputHTMLAttributes<HTMLInputElement>\n\nexport default function AddressAutocomplete({\n  countrycodes,\n  label,\n  onSelected,\n  onChange,\n  disableStyles,\n  ...props\n}: Props) {\n  const { data, setAddress, clear, status } = useFetch({ countrycodes })\n  const id = useId()\n  const inputId = `input_${id}`\n  const listId = `list_${id}`\n  const [textfield, setTextfield] = useState('')\n\n  const debouncedSearchQuery = useDebounce(textfield, 600)\n\n  useEffect(() => {\n    setAddress(textfield)\n  }, [debouncedSearchQuery])\n\n  const results = data.filter((mapData) => mapData.display_name !== textfield)\n  const hasResults = !!textfield && !!results.length\n\n  return (\n    <div\n      className={`rottitime-address ${disableStyles ? 'diable-styles' : 'enable-styles'}`}\n    >\n      {!!label && <label htmlFor={inputId}>{label}</label>}\n      <div className=\"input-wrapper\">\n        <input\n          aria-label={label}\n          aria-owns={listId}\n          aria-autocomplete=\"list\"\n          autoComplete=\"off\"\n          type=\"text\"\n          id={inputId}\n          value={textfield}\n          onChange={(e) => {\n            setTextfield(e.target.value)\n            if (typeof onChange === 'function') onChange(e)\n          }}\n          {...props}\n        />\n        {status === 'fetching' && <Loader />}\n      </div>\n\n      <div role=\"listbox\" aria-live=\"polite\" id={listId} aria-expanded={hasResults}>\n        {hasResults && (\n          <ul>\n            {results.map((suggestion, index) => {\n              return (\n                <li\n                  key={index}\n                  onClick={() => {\n                    const mapData = data[index]\n                    setTextfield(mapData.display_name)\n                    clear()\n                    if (typeof onSelected === 'function') onSelected(mapData)\n                  }}\n                >\n                  {suggestion?.display_name}\n                </li>\n              )\n            })}\n          </ul>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":["f","require$$0","k","l","m","n","p","q","c","a","g","b","d","e","h","__name","reactJsxRuntime_production_min","module","useDebounce","value","delay","debouncedValue","setDebouncedValue","React","handler","apiUrl","useFetch","countrycodes","status","setStatus","useState","data","setData","address","params","useFetch$1","SvgComponent","props","ref","jsx","ForwardRef","forwardRef","Loader$1","AddressAutocomplete","label","onSelected","onChange","disableStyles","setAddress","clear","id","useId","inputId","listId","textfield","setTextfield","debouncedSearchQuery","useEffect","results","mapData","hasResults","jsxs","Loader","suggestion","index"],"mappings":"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","x_google_ignoreList":[0,1]}